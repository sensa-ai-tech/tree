import type { CaseChallenge } from '@/types/case';

export const IM_CASES: CaseChallenge[] = [
  {
    id: 'CASE-IM-001',
    title: '老年貓的體重減輕與多渴多尿',
    specialty: 'IM',
    cross_specialties: ['CPATH'],
    required_nodes: ['IM-L3-004', 'IM-L4-002', 'IM-L5-001'],
    difficulty: 3,
    species: '貓',
    scenario: {
      signalment: '12 歲已絕育雌性家貓（DSH），體重 3.5 kg',
      chief_complaint: '近 3 個月逐漸體重減輕，飼主注意到飲水量明顯增加、貓砂結塊變大',
      brief_history: '去年健檢血檢正常（Cre 1.5 mg/dL、SDMA 12 μg/dL）。近 3 個月體重由 4.2 kg 降至 3.5 kg。飲水量增加約 2 倍，貓砂結塊明顯增大。食慾尚可但偶有挑食。室內飼養，飲食為乾糧為主。定期疫苗與驅蟲。',
    },
    steps: [
      {
        step_number: 1,
        step_type: 'history_collection',
        title: '病史採集',
        prompt: '你需要進一步詢問哪些問題？請選擇最重要的 3 項。',
        available_actions: [
          '詢問排尿頻率與尿量變化的詳細時間軸',
          '詢問是否有嘔吐或腹瀉',
          '詢問飲食品牌與最近是否換糧',
          '詢問是否有口臭或流口水',
          '詢問活動力變化',
          '詢問是否使用任何藥物或保健品',
        ],
        correct_actions: [
          '詢問排尿頻率與尿量變化的詳細時間軸',
          '詢問是否有嘔吐或腹瀉',
          '詢問是否有口臭或流口水',
        ],
        feedback_correct: '很好！PU/PD 的時間軸有助於評估疾病進展速度。嘔吐/腹瀉可能提示尿毒症性胃炎或其他消化道問題。口臭是尿毒症的重要臨床提示。',
        feedback_incorrect: '對於老年貓體重減輕合併 PU/PD，PU/PD 時間軸是評估腎功能衰退速度的關鍵。嘔吐可能是尿毒症表現。口臭/口腔潰瘍在 CKD 晚期常見。',
        key_learning_points: [
          'PU/PD 是 CKD 最早期的臨床症狀之一（腎臟濃縮功能喪失）',
          '嘔吐與食慾下降提示氮血症程度可能已達 Stage 3 以上',
          '口臭/口腔潰瘍是尿毒症（Stage 4）的典型表現',
        ],
      },
      {
        step_number: 2,
        step_type: 'physical_examination',
        title: '理學檢查',
        prompt: '病史補充：PU/PD 約 2 個月前開始明顯，近 2 週偶爾嘔吐（每週 1-2 次），無腹瀉。飼主近日注意到口腔有異味。未使用任何藥物。請選擇最重要的理學檢查發現。',
        available_actions: [
          'BCS 3/9，肌肉量評分低（尤其背部與後肢），被毛粗糙',
          '口腔黏膜蒼白（提示貧血），可見口臭但無明顯潰瘍',
          '約 5% 脫水（皮膚彈性輕度下降）',
          '雙側腎臟觸診偏小且表面不規則',
          '心臟聽診可聞 Grade II/VI 收縮期雜音',
          '體溫 38.2°C，呼吸速率正常',
        ],
        correct_actions: [
          'BCS 3/9，肌肉量評分低（尤其背部與後肢），被毛粗糙',
          '口腔黏膜蒼白（提示貧血），可見口臭但無明顯潰瘍',
          '雙側腎臟觸診偏小且表面不規則',
        ],
        feedback_correct: '正確！肌肉消耗與低 BCS 是 CKD 慢性蛋白質消耗的表現。黏膜蒼白提示非再生性貧血（EPO 不足）。雙側小腎是 CKD 的典型超音波/觸診發現，提示慢性不可逆變化。',
        feedback_incorrect: '在 CKD 貓的理學檢查中，最關鍵的發現是營養狀態惡化（肌肉消耗）、貧血徵象（黏膜蒼白）以及腎臟大小異常。這三項直接反映疾病嚴重度。',
        key_learning_points: [
          '肌肉量評分比 BCS 更能反映 CKD 的蛋白質消耗',
          'CKD 晚期貧血多為非再生性（EPO 分泌不足）',
          '雙側腎臟縮小是 CKD（而非 AKI）的重要鑑別特徵',
        ],
      },
      {
        step_number: 3,
        step_type: 'differential_diagnosis',
        title: '鑑別診斷',
        prompt: '基於老年貓、漸進性體重減輕、PU/PD、偶爾嘔吐、腎臟偏小的資訊，請列出最可能的鑑別診斷清單（選擇 3 個最相關的）。',
        available_actions: [
          '慢性腎病（CKD）',
          '甲狀腺機能亢進',
          '糖尿病',
          '腸道淋巴瘤',
          '慢性胰臟炎',
          '肝臟脂肪變性',
        ],
        correct_actions: [
          '慢性腎病（CKD）',
          '甲狀腺機能亢進',
          '糖尿病',
        ],
        feedback_correct: '優秀！CKD 是首要考量（PU/PD + 小腎 + 貧血 + 體重減輕）。甲亢在老年貓盛行率高，且臨床表現可重疊（體重減輕、PU/PD）。糖尿病可引起 PU/PD 和體重減輕。需注意甲亢可掩蓋 CKD。',
        feedback_incorrect: '老年貓 PU/PD + 體重減輕的三大鑑別：CKD（最常見，腎臟小支持此診斷）、甲亢（老年貓高盛行率）、糖尿病。這三種疾病可共存，且甲亢可掩蓋 CKD（增加 GFR）。',
        key_learning_points: [
          '老年貓 PU/PD 的三大鑑別：CKD、甲亢、糖尿病',
          '甲亢增加 GFR 可掩蓋潛在 CKD，治療甲亢後 Cre 可能上升',
          '腎臟觸診偏小強烈支持 CKD 而非 AKI',
        ],
      },
      {
        step_number: 4,
        step_type: 'diagnostic_plan',
        title: '診斷計畫',
        prompt: '你會安排哪些檢查以確認診斷和進行 IRIS 分期？選擇最適當的 3 項。',
        available_actions: [
          '完整血液生化（BUN/Cre/SDMA/電解質/磷/Ca）+ CBC',
          '尿液分析（USG/UPC）+ 血壓測量',
          '血清 Total T4（排除甲亢）',
          '腹腔超音波',
          '胸腔 X 光',
          '骨髓穿刺',
        ],
        correct_actions: [
          '完整血液生化（BUN/Cre/SDMA/電解質/磷/Ca）+ CBC',
          '尿液分析（USG/UPC）+ 血壓測量',
          '血清 Total T4（排除甲亢）',
        ],
        feedback_correct: '完美！血液生化 + CBC 確認氮血症程度和貧血嚴重度。尿液分析評估濃縮功能（USG）和蛋白尿（UPC），血壓用於 IRIS 亞分期。T4 排除甲亢——在老年貓中必須同時評估。',
        feedback_incorrect: '血液生化（含 SDMA）和 CBC 是 CKD 評估的基礎。尿液分析（USG + UPC）和血壓是 IRIS 亞分期的必要項目。T4 在所有老年貓 PU/PD 評估中都應納入，因為甲亢可掩蓋 CKD。',
        key_learning_points: [
          'IRIS 分期需要：Cre/SDMA（主分期）+ UPC（蛋白尿亞分期）+ 血壓（血壓亞分期）',
          '老年貓 PU/PD 必須同時檢查 T4 排除甲亢',
          'CBC 評估貧血程度有助於了解 CKD 嚴重度',
        ],
      },
      {
        step_number: 5,
        step_type: 'result_interpretation',
        title: '檢查結果判讀',
        prompt: '檢查結果如下：\n• 血檢：Cre 4.2 mg/dL、BUN 78 mg/dL、SDMA 48 μg/dL、磷 7.2 mg/dL、K 3.2 mEq/L（低）\n• CBC：PCV 22%（低，非再生性）、WBC 正常\n• T4：2.8 μg/dL（正常範圍 1.0-4.0）\n• 尿液分析：USG 1.016、UPC 0.55\n• 血壓：172 mmHg\n\n這些結果指向什麼結論？',
        available_actions: [
          'CKD IRIS Stage 3 / 蛋白尿 / 中度高血壓',
          'CKD IRIS Stage 2 / 邊緣蛋白尿 / 輕度高血壓',
          'CKD IRIS Stage 4 / 蛋白尿 / 重度高血壓',
          '甲亢合併腎前性氮血症',
        ],
        correct_actions: [
          'CKD IRIS Stage 3 / 蛋白尿 / 中度高血壓',
        ],
        feedback_correct: '正確！Cre 4.2 mg/dL 落在 Stage 3（2.9-5.0），SDMA 48 也對應 Stage 3（36-54）。UPC 0.55 > 0.4 = 蛋白尿。血壓 172 mmHg 在 160-179 範圍 = 中度高血壓。T4 正常排除甲亢。低鉀和非再生性貧血是 CKD Stage 3 的典型併發症。',
        feedback_incorrect: '仔細看數據：Cre 4.2 落在 2.9-5.0 範圍 = Stage 3（不是 Stage 4，Stage 4 需 > 5.0）。UPC 0.55 > 0.4 = 蛋白尿。血壓 172 在 160-179 範圍 = 中度高血壓。T4 正常排除甲亢。',
        key_learning_points: [
          'IRIS Stage 3：Cre 2.9-5.0 / SDMA 36-54，中度氮血症',
          '貓 UPC > 0.4 為蛋白尿，犬 UPC > 0.5',
          '非再生性貧血在 CKD 中反映 EPO 分泌不足',
          '低鉀血症在 CKD 貓中常見，需口服補充',
        ],
      },
      {
        step_number: 6,
        step_type: 'treatment_plan',
        title: '治療計畫',
        prompt: 'CKD IRIS Stage 3 / 蛋白尿 / 中度高血壓的治療方案為何？選擇最適當的組合。',
        available_actions: [
          '腎臟處方飲食（濕食為主）+ Telmisartan 1 mg/kg PO SID + Amlodipine 0.625 mg PO SID + 磷結合劑 + 鉀補充',
          '僅腎臟處方飲食和充足飲水',
          '腎臟處方飲食 + Benazepril 0.5 mg/kg PO SID',
          'Prednisolone 1 mg/kg PO SID + 止吐劑',
        ],
        correct_actions: [
          '腎臟處方飲食（濕食為主）+ Telmisartan 1 mg/kg PO SID + Amlodipine 0.625 mg PO SID + 磷結合劑 + 鉀補充',
        ],
        feedback_correct: '完美！Stage 3 需要多管齊下：腎臟處方飲食（限磷、適量蛋白，濕食增加水分攝取）。Telmisartan 抗蛋白尿（UPC 0.55）。Amlodipine 控制高血壓（貓高血壓首選）。磷結合劑控制高磷血症（磷 7.2）。口服鉀補充糾正低鉀（K 3.2）。',
        feedback_incorrect: 'Stage 3 合併蛋白尿和高血壓需要積極治療：飲食管理是基礎但不夠。蛋白尿需要 Telmisartan 或 Benazepril。貓高血壓首選 Amlodipine。高磷需磷結合劑。低鉀需補充。',
        key_learning_points: [
          'CKD Stage 3 需要多管齊下的治療策略',
          'Telmisartan（ARB）或 Benazepril（ACEI）用於抗蛋白尿',
          'Amlodipine 是貓 CKD 高血壓的首選降壓藥',
          '磷結合劑在 Stage 3-4 是標準治療',
          '低鉀血症在 CKD 貓中常見，口服 K-citrate 補充',
        ],
      },
      {
        step_number: 7,
        step_type: 'case_summary',
        title: '病例總結與追蹤',
        prompt: '請選擇最適當的追蹤計畫和飼主衛教重點。',
        available_actions: [
          '2 週後回診追蹤 Cre/BUN/K/磷/血壓，之後每 2-3 個月回診。教導飼主監測飲水量、食慾、體重變化。討論濕食轉換和居家皮下輸液的可能性。',
          '1 個月後回診即可，追蹤血檢',
          '3 個月後回診追蹤完整血檢和尿液分析',
          '症狀惡化時再回診',
        ],
        correct_actions: [
          '2 週後回診追蹤 Cre/BUN/K/磷/血壓，之後每 2-3 個月回診。教導飼主監測飲水量、食慾、體重變化。討論濕食轉換和居家皮下輸液的可能性。',
        ],
        feedback_correct: '正確！開始新藥物後 2 週需追蹤腎功能（Telmisartan/Amlodipine 可能影響腎灌注）和電解質。穩定後每 2-3 個月回診。飼主衛教重點：飲水量與食慾監測、體重追蹤、濕食轉換促進水分攝取。Stage 3 可開始考慮居家皮下輸液。',
        feedback_incorrect: '新開始抗蛋白尿藥物和降壓藥後，必須在 2 週內追蹤腎功能和電解質——這些藥物可能影響 GFR。Stage 3 CKD 需要密切追蹤，等待 1-3 個月太久。居家皮下輸液在 Stage 3 可開始討論。',
        key_learning_points: [
          '開始 ACEI/ARB 和降壓藥後 2 週需追蹤腎功能',
          'CKD Stage 3 每 2-3 個月回診追蹤',
          '濕食轉換可增加水分攝取，對 CKD 貓尤其重要',
          '居家皮下輸液在 Stage 3-4 可改善生活品質',
          '飼主衛教和生活品質評估是長期管理的核心',
        ],
      },
    ],
    expert_pathway: {
      reasoning: '12 歲老年貓 + 漸進性 PU/PD + 體重減輕 + 腎臟偏小 → CKD 高度懷疑。系統性檢查確認 IRIS Stage 3，合併蛋白尿與高血壓。排除甲亢後，啟動多管齊下的治療並安排密切追蹤。',
      key_decisions: [
        '優先排除甲亢——老年貓 PU/PD 的重要鑑別',
        '完成 IRIS 全分期（主分期 + 蛋白尿 + 血壓亞分期）',
        '針對每個異常發現制定對應治療（蛋白尿→Telmisartan、高血壓→Amlodipine、高磷→磷結合劑、低鉀→K-citrate）',
        '2 週內追蹤腎功能確認藥物安全性',
      ],
      common_pitfalls: [
        '未測 T4 而遺漏甲亢（甲亢可掩蓋 CKD）',
        '忘記 IRIS 亞分期（蛋白尿和血壓），導致治療不完整',
        '過度限制蛋白質導致肌肉消耗加劇',
        '開始新藥後未及時追蹤腎功能',
        '忽略低鉀血症的補充',
      ],
    },
    related_nodes_for_review: [
      'IM-L3-004',
      'IM-L4-002',
      'IM-L5-001',
      'IM-L1-002',
      'IM-L2-001',
    ],
    tags: ['CKD', 'IRIS', '貓', '腎臟', '老年貓', 'case_challenge'],
  },
];
